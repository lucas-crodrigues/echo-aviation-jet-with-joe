---
import IndexLayout from "../../../layouts/IndexLayout.astro";
import HomeHeader from "../../../components/HomeHeader.astro";
import FlightSchoolFeatures from "../../../components/FlightSchoolFeatures.astro";
import FlightTrainingSection from "../../../components/FlightTrainingSection.astro";
import YouTubeSection from "../../../components/YouTubeSection.astro";
import Welcome from "../../../components/Welcome.astro";
import FlightTrainingAdvantages from "../../../components/FlightTrainingAdvantages.astro";
import { GeneralFAQs } from "../../../data/general-faqs";
import FAQs from "../../../components/FAQs";
import FAQSchema from "../../../components/FAQSchema.astro";
import CTAFinancing from "../../../components/CTAFinancing.astro";
import financingCompData from "../../../data/financingComp";
import CTAColor from "../../../components/CTAColor.astro";
import CTAFlight from "../../../data/CTAFlight.js";
import ContactUs from "../../../components/ContactUs.astro";
import locations from "../../../data/locations/locations.js";
import videos from "../../../data/videos.js";

export function getStaticPaths() {
  const paths = [];

  for (const [stateKey, stateData] of Object.entries(locations)) {
    stateData.cities.forEach((city) => {
      paths.push({
        params: {
          state: stateData.slug,
          slug: city.data.slug,
        },
        props: {
          data: city.data,
        },
      });
    });
  }

  return paths;
}

const { data } = Astro.props;

const faqSchemaItems = GeneralFAQs.map((faq) => ({
  question: faq.title,
  answer: faq.content.replace(/<[^>]*>?/gm, ""),
}));

const videosData = videos.jetWithJoe.slice(0, 2) || [];
const videoSectionData = {
  title: "Jet With Joe YouTube Channel",
  description: "Explore our latest flight training videos, tutorials, and student journeys.",
};
---

<IndexLayout siteTitle={data.pageTitle}>
  <HomeHeader data={data.headerData}/>
  <FlightSchoolFeatures />
  <FlightTrainingSection />
  <Welcome content={data.heroContent} />
  <FlightTrainingAdvantages />
  <CTAFinancing content={financingCompData} />
  <YouTubeSection videos={videosData} videoSectionData={videoSectionData} />
  <FAQs faqs={GeneralFAQs} type="General" client:visible />
  <FAQSchema items={faqSchemaItems} />
  <ContactUs />
  <CTAColor content={CTAFlight} />
</IndexLayout>
